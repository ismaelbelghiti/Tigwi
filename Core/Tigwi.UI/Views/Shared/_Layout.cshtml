@using Tigwi.UI.Models
@using Tigwi.UI.Models.Account
@using Tigwi.UI.Models.User

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>@ViewBag.Title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="description" content=""/>
        <meta name="author" content=""/>

        <link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet"/>
        @*<link href="@Url.Content("~/Content/bootstrap-responsive.min.css")" rel="stylesheet"/>*@
        <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet"/>
        <script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/modernizr-2.5.3.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/bootstrap.js")" type="text/javascript"></script>

        <script type="text/javascript">
            $('.dropdown-toggle').dropdown();

            $('.dropdown input, .dropdown label').click(function (e) {
                e.stopPropagation();
            });
        </script>
        
    </head>

    <body>
        
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <div class="span8 offset2">
                        <ul class="nav">
                            @if (@User.Identity.IsAuthenticated )
                            {
                                <li @((ViewContext.Controller.ValueProvider.GetValue("controller").RawValue.ToString() == "Home") ? Html.Raw("class=\"active\"") : Html.Raw("class=\"\""))>@Html.ActionLink("Home", "Index", "Home")</li>
                                <li class="dropdown">  
                                    <a href="#"
                                       class="dropdown-toggle"
                                       data-toggle="dropdown">
                                        @CurrentAccount.Name
                                        <b class="caret"></b>
                                    </a>
                                    <ul class="dropdown-menu">
                                  
                                        @foreach (var acc in CurrentUser.Accounts)
                                        {
                                            <li>@Html.ActionLink(acc.Name, "MakeActive", "Account", new { accountName = acc.Name },null)</li> 
                                        }
                                        <li class="divider"></li>
                                        <li><a data-toggle="modal" href="#addAccountModal" >Add Account</a></li>
                                    </ul>
                          
                                </li>
                                <li @((ViewBag.Cur == "Favs") ? Html.Raw("class=\"active\"") : Html.Raw("class=\"\""))>@Html.ActionLink("Favs", "Index", "Home")</li>
                            }
                            else
                            {     
                                <li><a data-toggle="modal" href="#registerModal" >Register</a></li>
                                <li class="dropdown">
                                    <a class="dropdown-toggle" href="#" data-toggle="dropdown">Login</a>
                                    <div class="dropdown-menu" style="padding: 15px; padding-bottom: 0px;">
                                        @Html.Partial("_LogOnPartial", new UserLogOnViewModel())
                                    </div>
                                </li>
                            }
                        </ul>
                        <img src="@Url.Content("~/Content/images/bunny.png")" class="center-bunny"/>
                        <div class="navbar-right pull-right">
                            @Html.Partial("_Search", new SearchViewModel())
                            <ul class="nav">
                                @if (@User.Identity.IsAuthenticated)
                                {
                                    <li class="dropdown">
                                        <a href="#"
                                           class="dropdown-toggle"
                                           data-toggle="dropdown">
                                            <i class="icon-cog icon-white"> </i>
                                            <b class="caret"></b>
                                        </a>
                                        <ul class="dropdown-menu">
                                            <li>@Html.ActionLink("Accounts", "List", "Account")</li>
                                            <li class="divider"></li>
                                            <li>@Html.ActionLink("Disconnect", "LogOut", "User")</li>
                                        </ul>
                                    </li>
                                }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="container">
            <div class="row">
                <section class="span2 offset2">
                    <section class="leftInfos">
                        @RenderSection("LeftInfos", false)
                    </section>
                </section>
                <section class="span6">
                    @RenderSection("Main",false)
                </section>

            </div>

            <section class="modal hide" id="registerModal">
                @Html.Partial("_RegisterModal", new RegisterViewModel())
            </section>
            
            <section class="modal hide" id="addAccountModal">
                @Html.Partial("_CreateAccountModal", new AccountCreationViewModel())
            </section>
            
            <section class="modal hide" id="deleteAccountModal">
                @Html.Partial("_ConfirmDeleteAccountModal", null)
            </section>

            <div class="row">
                <section class="span8 offset2">
                    <footer style="padding-top: 40px; padding-left: 40px;">
                        <p>&copy; Tigwi 2012</p>
                    </footer>
                </section>
            </div>
        </div>


    </body>

</html>

